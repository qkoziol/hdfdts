# Makefile to build the IO speed measurement tool.

# Change this if you want to use a compiler other than gcc.
CC=gcc

# Uncomment these if you want to use FFIO.
#FFIO_CPPFLAGS=-DHAVE_FFIO
#FFIO_LIBS=-lffio -lrt

# Uncomment these if you want to use MMAP
#MMAP_CPPFLAGS=-DHAVE_MMAP

# Uncomment these if Aligned memory is supported.
#HAVE_ALIGNED=-DHAVE_ALIGNED

# If errors, such as integer overflow, occur for file size larger than 2GB,
# you may want to uncomment the GCC_CPPFLAGS here.
#GCC_CPPFLAGS=-D_LARGEFILE_SOURCE -D_LARGEFILE64_SOURCE -D_FILE_OFFSET_BITS=64

# need _XOPEN_SOURCE=600 to include the definition of posix_memalign().
CPPFLAGS=-D_XOPEN_SOURCE=600 $(FFIO_CPPFLAGS) $(MMAP_CPPFLAGS) $(HAVE_ALIGNED) $(GCC_CPPFLAGS)
CFLAGS=-DNDEBUG $(CPPFLAGS)
LIBS=$(FFIO_LIBS)


iospeed: gopt.c iospeed.c
	$(CC) $(CFLAGS) gopt.c iospeed.c $(LIBS) -o $@

clean:
	rm -f iospeed
